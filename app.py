# -*- coding: utf-8 -*-

"""
ждЎТИ»У│йждгтѕєТъљТЄЅуће - ТЋ┤тљѕуЅѕ v14.0№╝ѕтљФжЁЇУЁ│УЕЋтѕє№╝Ѕ

HKJC Race Analysis Application - Integrated Edition v14.0 - With Leg Fitness Scoring

Рюе v14.0 Тќ░тбъ:
- ­ЪЈЄ ТјњСйЇУАетѕєТъљ жаЂжЮбТЋ┤тљѕ
- жЁЇУЁ│УЕЋтѕєУеѕу«Ќ (тюеТјњСйЇУАетѕєТъљжаЂжЮбт║ЋжЃе)
- УЕЋтѕєухљТъют»дТЎѓжА»уц║№╝ѕуёАТќ░ТеЎу▒цжаЂ№╝Ѕ
- уѕгУЪ▓ Рєњ ТјњСйЇУАе Рєњ жЁЇУЁ│УЕЋтѕє т«їТЋ┤ТхЂуеІ

­ЪЊд ТеАухётїќТъХТДІ:
- analyzers/ - тѕєТъљжѓЈУ╝»т▒ц
- pages/ - UI жаЂжЮбт▒ц
- app.py - ТЄЅућетЁЦтЈБ + тЁ▒ућеТЋИТЊџ

уЅѕТюг: 14.0
ТЌЦТюЪ: 2026-01-12
"""

import streamlit as st
from pages import render_segment_page, render_pace_page, render_report_page
from pages.page_pace_prediction import render_pace_prediction_page
from pages.page_database_monitor import render_database_page
from pages.page_draw_statistics import render_draw_statistics_page
from pages.page_racecard import render_racecard_page

# ============================================================================
# Streamlit жЁЇуй«
# ============================================================================

st.set_page_config(
    page_title="HKJC У│йждгтѕєТъљтиЦтЁи",
    layout="wide",
    page_icon="­Ъљ┤"
)

# ============================================================================
# Рюе тѕЮтДІтїќтЁет▒ђТЋИТЊџт║Ф№╝ѕтЃЁтюеТЄЅућетЋЪтІЋТЎѓтЪиУАїСИђТгА№╝Ѕ
# ============================================================================

if 'db_manager' not in st.session_state:
    from analyzers.db_manager import DatabaseManager
    st.session_state.db_manager = DatabaseManager('hkjc_data.db')
    print("РюЁ тЁет▒ђТЋИТЊџт║Фти▓тѕЮтДІтїќ")

# ============================================================================
# т«ўТќ╣ТеЎТ║ќТЎѓжќЊТЋИТЊџ№╝ѕтЁ▒ућеТЋИТЊџ - С┐ЮуЋЎтюе app.py№╝Ѕ
# ============================================================================

STANDARD_TIMES_DATA = {

    'Sha Tin': {

        1000: {

            'тѕєу┤џУ│й': (55.90, {'Ухиж╗ъ-800': 13.05, '800-400': 20.60, '400-ухѓж╗ъ': 22.25}),

            'Тќ░ждгУ│й': (56.65, {'Ухиж╗ъ-800': 13.25, '800-400': 20.80, '400-ухѓж╗ъ': 22.60}),

            'уггС║їуЈГ': (56.05, {'Ухиж╗ъ-800': 13.10, '800-400': 20.60, '400-ухѓж╗ъ': 22.35}),

            'уггСИЅуЈГ': (56.45, {'Ухиж╗ъ-800': 13.05, '800-400': 20.65, '400-ухѓж╗ъ': 22.75}),

            'уггтЏЏуЈГ': (56.65, {'Ухиж╗ъ-800': 13.00, '800-400': 20.75, '400-ухѓж╗ъ': 22.90}),

            'уггС║ћуЈГ': (57.00, {'Ухиж╗ъ-800': 13.15, '800-400': 20.95, '400-ухѓж╗ъ': 22.90}),

        },

        1200: {

            'тѕєу┤џУ│й': (68.15, {'Ухиж╗ъ-800': 23.55, '800-400': 22.20, '400-ухѓж╗ъ': 22.40}),

            'Тќ░ждгУ│й': (69.90, {'Ухиж╗ъ-800': 23.95, '800-400': 22.95, '400-ухѓж╗ъ': 23.00}),

            'уггСИђуЈГ': (68.45, {'Ухиж╗ъ-800': 23.60, '800-400': 22.25, '400-ухѓж╗ъ': 22.60}),

            'уггС║їуЈГ': (68.65, {'Ухиж╗ъ-800': 23.75, '800-400': 22.25, '400-ухѓж╗ъ': 22.65}),

            'уггСИЅуЈГ': (69.00, {'Ухиж╗ъ-800': 23.70, '800-400': 22.35, '400-ухѓж╗ъ': 22.95}),

            'уггтЏЏуЈГ': (69.35, {'Ухиж╗ъ-800': 23.75, '800-400': 22.45, '400-ухѓж╗ъ': 23.15}),

            'уггС║ћуЈГ': (69.55, {'Ухиж╗ъ-800': 23.85, '800-400': 22.40, '400-ухѓж╗ъ': 23.30}),

        },

        1400: {

            'тѕєу┤џУ│й': (81.10, {'Ухиж╗ъ-1200': 13.50, '1200-800': 22.35, '800-400': 22.85, '400-ухѓж╗ъ': 22.40}),

            'уггСИђуЈГ': (81.25, {'Ухиж╗ъ-1200': 13.65, '1200-800': 22.00, '800-400': 22.90, '400-ухѓж╗ъ': 22.70}),

            'уггС║їуЈГ': (81.45, {'Ухиж╗ъ-1200': 13.45, '1200-800': 21.90, '800-400': 23.10, '400-ухѓж╗ъ': 23.00}),

            'уггСИЅуЈГ': (81.65, {'Ухиж╗ъ-1200': 13.45, '1200-800': 21.80, '800-400': 23.15, '400-ухѓж╗ъ': 23.25}),

            'уггтЏЏуЈГ': (82.00, {'Ухиж╗ъ-1200': 13.45, '1200-800': 21.75, '800-400': 23.40, '400-ухѓж╗ъ': 23.40}),

            'уггС║ћуЈГ': (82.30, {'Ухиж╗ъ-1200': 13.40, '1200-800': 21.90, '800-400': 23.35, '400-ухѓж╗ъ': 23.65}),

        },

        1600: {

            'тѕєу┤џУ│й': (93.90, {'Ухиж╗ъ-1200': 24.85, '1200-800': 23.05, '800-400': 23.25, '400-ухѓж╗ъ': 22.75}),

            'уггСИђуЈГ': (94.05, {'Ухиж╗ъ-1200': 24.75, '1200-800': 23.15, '800-400': 23.15, '400-ухѓж╗ъ': 23.00}),

            'уггС║їуЈГ': (94.25, {'Ухиж╗ъ-1200': 24.55, '1200-800': 23.15, '800-400': 23.45, '400-ухѓж╗ъ': 23.10}),

            'уггСИЅуЈГ': (94.70, {'Ухиж╗ъ-1200': 24.50, '1200-800': 22.90, '800-400': 23.80, '400-ухѓж╗ъ': 23.50}),

            'уггтЏЏуЈГ': (94.90, {'Ухиж╗ъ-1200': 24.50, '1200-800': 22.90, '800-400': 23.80, '400-ухѓж╗ъ': 23.70}),

            'уггС║ћуЈГ': (95.45, {'Ухиж╗ъ-1200': 24.55, '1200-800': 23.15, '800-400': 23.85, '400-ухѓж╗ъ': 23.90}),

        },

        1800: {

            'тѕєу┤џУ│й': (107.10, {'Ухиж╗ъ-1600': 14.05, '1600-1200': 22.80, '1200-800': 24.00, '800-400': 23.50, '400-ухѓж╗ъ': 22.75}),

            'уггС║їуЈГ': (107.30, {'Ухиж╗ъ-1600': 14.00, '1600-1200': 22.60, '1200-800': 23.95, '800-400': 23.35, '400-ухѓж╗ъ': 23.40}),

            'уггСИЅуЈГ': (107.50, {'Ухиж╗ъ-1600': 13.85, '1600-1200': 22.30, '1200-800': 23.80, '800-400': 24.00, '400-ухѓж╗ъ': 23.55}),

            'уггтЏЏуЈГ': (107.85, {'Ухиж╗ъ-1600': 13.85, '1600-1200': 22.20, '1200-800': 23.85, '800-400': 24.20, '400-ухѓж╗ъ': 23.75}),

            'уггС║ћуЈГ': (108.45, {'Ухиж╗ъ-1600': 13.95, '1600-1200': 22.25, '1200-800': 23.85, '800-400': 24.20, '400-ухѓж╗ъ': 24.20}),

        },

        2000: {

            'тѕєу┤џУ│й': (120.50, {'Ухиж╗ъ-1600': 25.95, '1600-1200': 23.90, '1200-800': 23.90, '800-400': 23.55, '400-ухѓж╗ъ': 23.20}),

            'уггСИђуЈГ': (121.20, {'Ухиж╗ъ-1600': 26.10, '1600-1200': 24.35, '1200-800': 23.95, '800-400': 23.60, '400-ухѓж╗ъ': 23.20}),

            'уггС║їуЈГ': (121.70, {'Ухиж╗ъ-1600': 26.05, '1600-1200': 24.65, '1200-800': 24.20, '800-400': 23.40, '400-ухѓж╗ъ': 23.40}),

            'уггСИЅуЈГ': (121.90, {'Ухиж╗ъ-1600': 26.05, '1600-1200': 24.70, '1200-800': 24.05, '800-400': 23.55, '400-ухѓж╗ъ': 23.55}),

            'уггтЏЏуЈГ': (122.35, {'Ухиж╗ъ-1600': 25.85, '1600-1200': 24.40, '1200-800': 24.40, '800-400': 23.95, '400-ухѓж╗ъ': 23.75}),

            'уггС║ћуЈГ': (122.65, {'Ухиж╗ъ-1600': 25.75, '1600-1200': 24.40, '1200-800': 24.35, '800-400': 23.95, '400-ухѓж╗ъ': 24.20}),

        },

        2400: {

            'тѕєу┤џУ│й': (147.00, {'Ухиж╗ъ-2000': 25.60, '2000-1600': 24.50, '1600-1200': 25.35, '1200-800': 23.85, '800-400': 23.75, '400-ухѓж╗ъ': 23.95}),

        },

    },

    'Sha Tin AW': {

        1200: {

            'уггС║їуЈГ': (68.35, {'Ухиж╗ъ-800': 23.35, '800-400': 21.95, '400-ухѓж╗ъ': 23.05}),

            'уггСИЅуЈГ': (68.55, {'Ухиж╗ъ-800': 23.30, '800-400': 22.05, '400-ухѓж╗ъ': 23.20}),

            'уггтЏЏуЈГ': (68.95, {'Ухиж╗ъ-800': 23.30, '800-400': 22.10, '400-ухѓж╗ъ': 23.55}),

            'уггС║ћуЈГ': (69.35, {'Ухиж╗ъ-800': 23.35, '800-400': 22.35, '400-ухѓж╗ъ': 23.65}),

        },

        1650: {

            'уггСИђуЈГ': (97.80, {'Ухиж╗ъ-1200': 27.80, '1200-800': 22.85, '800-400': 23.25, '400-ухѓж╗ъ': 23.90}),

            'уггС║їуЈГ': (98.40, {'Ухиж╗ъ-1200': 27.90, '1200-800': 23.55, '800-400': 23.05, '400-ухѓж╗ъ': 23.90}),

            'уггСИЅуЈГ': (98.60, {'Ухиж╗ъ-1200': 27.90, '1200-800': 23.00, '800-400': 23.75, '400-ухѓж╗ъ': 23.95}),

            'уггтЏЏуЈГ': (99.05, {'Ухиж╗ъ-1200': 27.95, '1200-800': 23.15, '800-400': 23.80, '400-ухѓж╗ъ': 24.15}),

            'уггС║ћуЈГ': (99.45, {'Ухиж╗ъ-1200': 27.95, '1200-800': 23.20, '800-400': 24.00, '400-ухѓж╗ъ': 24.30}),

        },

        1800: {

            'уггСИЅуЈГ': (108.05, {'Ухиж╗ъ-1600': 13.75, '1600-1200': 22.80, '1200-800': 23.70, '800-400': 23.85, '400-ухѓж╗ъ': 23.95}),

            'уггтЏЏуЈГ': (108.55, {'Ухиж╗ъ-1600': 13.60, '1600-1200': 23.10, '1200-800': 24.05, '800-400': 23.65, '400-ухѓж╗ъ': 24.15}),

            'уггС║ћуЈГ': (109.45, {'Ухиж╗ъ-1600': 13.75, '1600-1200': 23.20, '1200-800': 23.95, '800-400': 24.25, '400-ухѓж╗ъ': 24.30}),

        },

    },

    'Happy Valley': {

        1000: {

            'Тќ░ждгУ│й': (56.65, {'Ухиж╗ъ-800': 13.25, '800-400': 20.80, '400-ухѓж╗ъ': 22.60}),

            'уггС║їуЈГ': (56.40, {'Ухиж╗ъ-800': 12.45, '800-400': 21.00, '400-ухѓж╗ъ': 22.95}),

            'уггСИЅуЈГ': (56.65, {'Ухиж╗ъ-800': 12.50, '800-400': 21.00, '400-ухѓж╗ъ': 23.15}),

            'уггтЏЏуЈГ': (57.20, {'Ухиж╗ъ-800': 12.55, '800-400': 21.30, '400-ухѓж╗ъ': 23.35}),

            'уггС║ћуЈГ': (57.35, {'Ухиж╗ъ-800': 12.60, '800-400': 21.40, '400-ухѓж╗ъ': 23.35}),

        },

        1200: {

            'Тќ░ждгУ│й': (69.90, {'Ухиж╗ъ-800': 23.95, '800-400': 22.95, '400-ухѓж╗ъ': 23.00}),

            'уггСИђуЈГ': (69.10, {'Ухиж╗ъ-800': 23.55, '800-400': 22.30, '400-ухѓж╗ъ': 23.25}),

            'уггС║їуЈГ': (69.30, {'Ухиж╗ъ-800': 23.45, '800-400': 22.35, '400-ухѓж╗ъ': 23.50}),

            'уггСИЅуЈГ': (69.60, {'Ухиж╗ъ-800': 23.50, '800-400': 22.55, '400-ухѓж╗ъ': 23.55}),

            'уггтЏЏуЈГ': (69.90, {'Ухиж╗ъ-800': 23.65, '800-400': 22.70, '400-ухѓж╗ъ': 23.55}),

            'уггС║ћуЈГ': (70.10, {'Ухиж╗ъ-800': 23.70, '800-400': 22.75, '400-ухѓж╗ъ': 23.65}),

        },

        1650: {

            'уггСИђуЈГ': (99.10, {'Ухиж╗ъ-1200': 28.45, '1200-800': 23.90, '800-400': 23.35, '400-ухѓж╗ъ': 23.40}),

            'уггС║їуЈГ': (99.30, {'Ухиж╗ъ-1200': 28.00, '1200-800': 23.85, '800-400': 23.80, '400-ухѓж╗ъ': 23.65}),

            'уггСИЅуЈГ': (99.90, {'Ухиж╗ъ-1200': 27.95, '1200-800': 23.85, '800-400': 24.25, '400-ухѓж╗ъ': 23.85}),

            'уггтЏЏуЈГ': (100.10, {'Ухиж╗ъ-1200': 28.00, '1200-800': 23.80, '800-400': 24.25, '400-ухѓж╗ъ': 24.05}),

            'уггС║ћуЈГ': (100.30, {'Ухиж╗ъ-1200': 27.95, '1200-800': 23.90, '800-400': 24.25, '400-ухѓж╗ъ': 24.20}),

        },

        1800: {

            'тѕєу┤џУ│й': (108.95, {'Ухиж╗ъ-1600': 13.65, '1600-1200': 22.90, '1200-800': 24.35, '800-400': 24.15, '400-ухѓж╗ъ': 23.90}),

            'Тќ░ждгУ│й': (110.20, {'Ухиж╗ъ-1600': 13.80, '1600-1200': 23.25, '1200-800': 24.50, '800-400': 24.30, '400-ухѓж╗ъ': 24.35}),

            'уггС║їуЈГ': (109.15, {'Ухиж╗ъ-1600': 13.65, '1600-1200': 22.80, '1200-800': 24.55, '800-400': 24.20, '400-ухѓж╗ъ': 23.95}),

            'уггСИЅуЈГ': (109.45, {'Ухиж╗ъ-1600': 13.75, '1600-1200': 23.00, '1200-800': 24.30, '800-400': 24.45, '400-ухѓж╗ъ': 23.95}),

            'уггтЏЏуЈГ': (109.65, {'Ухиж╗ъ-1600': 13.75, '1600-1200': 22.90, '1200-800': 24.35, '800-400': 24.35, '400-ухѓж╗ъ': 24.30}),

            'уггС║ћуЈГ': (109.95, {'Ухиж╗ъ-1600': 13.70, '1600-1200': 22.80, '1200-800': 24.50, '800-400': 24.40, '400-ухѓж╗ъ': 24.55}),

        },

        2200: {

            'уггСИЅуЈГ': (136.60, {'Ухиж╗ъ-2000': 14.35, '2000-1600': 23.70, '1600-1200': 24.95, '1200-800': 24.85, '800-400': 24.45, '400-ухѓж╗ъ': 24.30}),

            'уггтЏЏуЈГ': (137.05, {'Ухиж╗ъ-2000': 14.40, '2000-1600': 23.60, '1600-1200': 25.25, '1200-800': 25.15, '800-400': 24.30, '400-ухѓж╗ъ': 24.35}),

            'уггС║ћуЈГ': (137.35, {'Ухиж╗ъ-2000': 14.35, '2000-1600': 23.70, '1600-1200': 25.40, '1200-800': 25.15, '800-400': 24.15, '400-ухѓж╗ъ': 24.60}),

        },

    },

}
# ============================================================================
# СИ╗ТЄЅућеуеІт╝Ј
# ============================================================================

st.title("­Ъљ┤ HKJC У│йждгтѕєТъљтиЦтЁи")

# Рюе СИ╗т░јУѕф - 7 тђІСИ╗УдЂтіЪУЃй Tab
tab1, tab2, tab3, tab4, tab5, tab6, tab7 = st.tabs([
    "­ЪЊі тѕєТ«хТЎѓжќЊтѕєТъљ",
    "­ЪЈє У│йС║ІТГЦжђЪтѕєТъљ",
    "­ЪЊѕ т«їТЋ┤тѕєТъљта▒тЉі",
    "­ЪЈЄ ТјњСйЇУАетѕєТъљ",  # РГљ ТЋ┤тљѕжЁЇУЁ│УЕЋтѕє
    "­ЪЈЃ УиЉТ│ЋжаљТИг",
    "­ЪњЙ ТЋИТЊџт║ФуЏБТјД",
    "­ЪЊї ТфћСйЇух▒Уеѕ"
])

# ============================================================================
# тѕєжаЂ 1№╝џтѕєТ«хТЎѓжќЊтѕєТъљ
# ============================================================================

with tab1:
    render_segment_page()

# ============================================================================
# тѕєжаЂ 2№╝џУ│йС║ІТГЦжђЪтѕєТъљ
# ============================================================================

with tab2:
    render_pace_page()

# ============================================================================
# тѕєжаЂ 3№╝џт«їТЋ┤тѕєТъљта▒тЉі
# ============================================================================

with tab3:
    render_report_page(STANDARD_TIMES_DATA)

# ============================================================================
# тѕєжаЂ 4№╝џТјњСйЇУАетѕєТъљ (РГљ ТЋ┤тљѕжЁЇУЁ│УЕЋтѕє)
# ============================================================================

with tab4:
    render_racecard_page()

# ============================================================================
# тѕєжаЂ 5№╝џУиЉТ│ЋжаљТИг
# ============================================================================

with tab5:
    render_pace_prediction_page()

# ============================================================================
# тѕєжаЂ 6№╝џТЋИТЊџт║ФуЏБТјД
# ============================================================================

with tab6:
    render_database_page()

# ============================================================================
# тѕєжаЂ 7№╝џТфћСйЇух▒Уеѕ
# ============================================================================

with tab7:
    render_draw_statistics_page()
